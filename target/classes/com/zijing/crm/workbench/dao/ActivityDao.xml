<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.zijing.crm.workbench.dao.ActivityDao">
	
	    <insert id="save">
        insert into tbl_activity(id,owner,name,startDate,endDate,cost,description,createTime,createBy)
        values (
                #{id},
                #{owner},
                #{name},
                #{startDate},
                #{endDate},
                #{cost},
                #{description},
                #{createTime},
                #{createBy}
                )

    </insert>

        <select id="getActivity" resultType="Activity">
                select * from tbl_activity
        </select>

        <select id="getActivityByCondition" resultType="Activity">
                select
                a.id,
                a.name,
                u.name as owner,
                a.startDate,
                a.endDate

                from tbl_activity a
                join tbl_user u
                on a.Owner = u.id
                <where>
                        <if test="name!=null and name!=''">
                                a.name like '%' #{name} '%'
                        </if>

                        <if test="Owner!=null and Owner!=''">
                                and u.name like '%' #{owner} '%'
                        </if>

                        <if test="starDate!=null and starDate!=''">
                                and a.starDate &gt; #{startDate}
                        </if>

                        <if test="endDate!=null and endDate!=''">
                                and a.endDate &lt; #{endDate}
                        </if>
                </where>
                order by
                a.createTime desc
                limit #{skipCount},#{pageSize}
        </select>

        <select id="getTotalByCondition" resultType="int">
                select
                count(*)
                from tbl_activity a
                join tbl_user u
                on a.Owner = u.id
                <where>
                        <if test="name!=null and name!=''">
                                a.name like '%' #{name} '%'
                        </if>

                        <if test="Owner!=null and Owner!=''">
                                and u.name like '%' #{owner} '%'
                        </if>

                        <if test="starDate!=null and starDate!=''">
                                and a.starDate &gt; #{startDate}
                        </if>

                        <if test="endDate!=null and endDate!=''">
                                and a.endDate &lt; #{endDate}
                        </if>
                </where>
        </select>

        <delete id="delete">
                delete
                from tbl_activity
                where id in
                <foreach collection="array" item="id" open="(" close=")" separator=",">
                        #{id}
                </foreach>
        </delete>

        <select id="getByid" resultType="Activity">
                select * from tbl_activity where id = #{id}
        </select>

        <update id="update">
           update  tbl_activity
               set
                   owner = #{owner},
                   name = #{name},
                   startDate = #{startDate},
                   endDate = #{endDate},
                   cost = #{cost},
                   description = #{description},
                   editTime = #{editTime},
                   editBy = #{editBy}
            where id = #{id}
        </update>

</mapper>

























